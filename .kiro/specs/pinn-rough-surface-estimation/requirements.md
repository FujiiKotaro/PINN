# Requirements Document

## Project Description (Input)
超音波非破壊検査における周期的粗面（ピッチ・深さパラメータ）の推定をPhysics-Informed Neural Networks (PINNs)により実現する。まずはFDTDデータからの学習と推定を行い，PINNのひな型を作成する。

## Requirements

### 1. 機能要件：PINNモデルによるパラメータ推定

**Objective:** 研究者として、超音波反射データから粗面のパラメータを自動で推定したい。これにより、手動での分析時間を削減し、客観的な評価を行えるようにする。

#### Acceptance Criteria
1. The システムは、PINNを用いて2D弾性波動方程式に支配される波の伝播を学習するものとする。
2. The システムは、ニューラルネットワークへの入力として時間 (t) および空間座標 (x, y) を使用するものとする。
3. The システムは、変位場または音圧場を出力するものとする。
4. When FDTDで生成された反射波形データが与えられたとき、the システムはその波形を最もよく再現する粗面の `pitch` および `depth` パラメータを推定するものとする。
5. The システムは、逆問題において `pitch` および `depth` を学習可能な変数として扱うものとする。
6. The システムは、推定精度の評価指標としてr2スコアを使用するものとする。

### 2. 機能要件：物理制約

**Objective:** 物理法則に基づいたモデルを構築したい。これにより、データの少ない領域でもっともらしい解を得られるようにする。

#### Acceptance Criteria
1. The システムは、2D弾性波動方程式の残差を損失関数に組み込むものとする。
2. The システムは、PDEおよび関連する変数を損失関数に組み込む前に無次元化するものとする。
3. The システムは、粗面境界における応力自由境界条件の損失項を組み込むものとする。
4. The システムは、データ忠実度項 (`L_data`)、PDE残差項 (`L_pde`)、および境界条件項 (`L_bc`) から構成される合計損失関数を構築するものとする。
5. The システムは、各損失項 (`w_data`, `w_pde`, `w_bc`) の重み付けを可能とするものとする。

### 3. 非機能要件

**Objective:** 最新のフレームワークを利用し、再現性のある開発を行いたい。

#### Acceptance Criteria
1. The システムは、DeepXDEライブラリを使用して実装されるものとする。
2. Where トレーニングまたは推定が実行される場合、the システムは指定されたパラメータ範囲内（深さ：0.01mm～0.30mm、ピッチ：1.25mm～2.00mm）で動作するものとする。