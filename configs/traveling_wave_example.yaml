# Traveling Wave Example Configuration
# This configuration demonstrates a 1D PINN setup for a traveling wave solution
# using d'Alembert's formula with Neumann boundary conditions.
#
# Analytical solution: u(x,t) = f(x - ct) + g(x + ct)

experiment_name: "traveling_wave_dalembert"

# Random seed for reproducibility
seed: 42

# Spatiotemporal domain configuration
domain:
  # Spatial domain: [0, 2] (wider domain for wave propagation)
  x_min: 0.0
  x_max: 2.0

  # Temporal domain: [0, 2]
  t_min: 0.0
  t_max: 2.0

  # Wave speed parameter (c)
  # Higher wave speed for faster propagation
  wave_speed: 1.5

# Boundary conditions configuration
boundary_conditions:
  # Type: "dirichlet", "neumann", or "periodic"
  # Neumann BC allows wave reflection at boundaries
  type: "neumann"

  # For Neumann BC: ∂u/∂n = 0 at boundaries (zero normal derivative)
  left_value: null
  right_value: null

# Neural network architecture
network:
  # Larger network for capturing traveling wave dynamics (Phase 2 expansion)
  layer_sizes: [2, 128, 128, 128, 128, 1]

  # Activation function
  activation: "tanh"

  # Fourier Feature Network for improved high-frequency learning
  use_fourier_features: true
  num_fourier_features: 128  # Reduced for stability
  fourier_scale: 1.0  # CRITICAL: Lower scale for stable initialization

# Training hyperparameters
training:
  # More epochs for traveling wave convergence (Phase 2: increased for larger network)
  epochs: 10000

  # Learning rate for optimizer (increased for Fourier Features)
  learning_rate: 0.001  

  # Optimizer: "adam" or "lbfgs"
  optimizer: "adam"

  # Loss function weights (Phase 2: Individual IC weights)
  # Emphasize PDE residual for traveling wave physics
  loss_weights:
    data: 0.5              # Lower data weight if using analytical solution
    pde: 10.0              # Higher PDE weight for physics enforcement
    bc: 20.0               # INCREASED: Strong BC weight for proper reflection (1.0 → 20.0)
    ic_displacement: 100.0 # Initial displacement (Gaussian pulse shape)
    ic_velocity: 100.0     # Initial velocity (zero velocity condition)

  # Enable automatic mixed precision for GPU memory efficiency
  amp_enabled: true

  # Checkpoint save interval (epochs)
  checkpoint_interval: 1000

  # Causal Training for improved temporal causality
  use_causal_training: true
  causal_beta: 0.5  # Gentle causal weighting (reduced from 2.0)

# Analytical solution configuration
analytical_solution:
  # Solution type: traveling wave (d'Alembert's solution)
  # NOTE: d'Alembert's solution is valid for infinite domain only.
  # With Neumann BC in finite domain, the wave reflects at boundaries,
  # making the analytical solution incompatible with the BC after reflection.
  solution_type: "traveling_wave"

  # Mode parameter (not used for traveling wave, but required)
  mode: 1

  # Initial amplitude
  initial_amplitude: 1.0

  # Disable validation for traveling wave with bounded domain
  # PINN will still learn the correct physics with BC enforcement
  enable_validation: false
